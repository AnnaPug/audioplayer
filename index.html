<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Genially Audio Player Editor</title>

<style>
:root {
  --main:#7b5cff;
  --text:#ffffff;
}

* { box-sizing:border-box; font-family:Inter,system-ui,sans-serif; }

body {
  margin:0;
  background:#0f0c1d;
  color:white;
}

.wrapper {
  display:grid;
  grid-template-columns:320px 1fr;
  gap:24px;
  padding:24px;
}

.panel {
  background:#18142f;
  padding:16px;
  border-radius:16px;
}

.panel h2 { margin-top:0; font-size:16px; }
.panel label { font-size:12px; opacity:.8; }

.panel input, textarea {
  width:100%;
  margin:6px 0 14px;
  padding:8px;
  border-radius:8px;
  border:none;
}

button {
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  background:var(--main);
  color:white;
  font-weight:600;
  cursor:pointer;
}

/* ===== PLAYER ===== */

.player {
  width:320px;
  background:linear-gradient(160deg,var(--main),#9a85ff);
  border-radius:20px;
  padding:16px;
  box-shadow:0 10px 30px rgba(123,92,255,.4);
}

.cover {
  width:100%;
  height:160px;
  border-radius:14px;
  background-size:cover;
  background-position:center;
  margin-bottom:10px;
}

.title { font-size:14px; font-weight:600; }

.progress {
  height:6px;
  background:rgba(255,255,255,.3);
  border-radius:6px;
  margin:10px 0;
  cursor:pointer;
}

.progress-bar {
  height:100%;
  width:0%;
  background:white;
  border-radius:6px;
}

.controls {
  display:flex;
  justify-content:space-between;
}

.controls button {
  width:auto;
  background:none;
  font-size:18px;
}

.playlist {
  display:none;
  margin-top:10px;
}

.track {
  font-size:13px;
  padding:4px;
  cursor:pointer;
}
.track.active { font-weight:bold; }
</style>
</head>

<body>

<div class="wrapper">

  <!-- EDITOR -->
  <div class="panel">
    <h2>üéõ –†–µ–¥–∞–∫—Ç–æ—Ä</h2>

    <label>–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç</label>
    <input type="color" id="color" value="#7b5cff">

    <label>–û–±–ª–æ–∂–∫–∞</label>
    <input id="coverInput" value="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4">

    <label>–¢—Ä–µ–∫–∏ (raw GitHub)</label>
    <textarea id="tracksInput">
https://raw.githubusercontent.com/AnnaPug/audioplayer/main/audio/track1.mp3
https://raw.githubusercontent.com/AnnaPug/audioplayer/main/audio/track2.mp3
    </textarea>

    <button onclick="render()">üëÄ –û–±–Ω–æ–≤–∏—Ç—å</button>
    <br><br>
    <button onclick="getCode()">üìã –ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
  </div>

  <!-- PREVIEW -->
  <div>
    <div id="preview"></div>
    <textarea id="result" style="width:100%;height:240px;margin-top:16px;display:none;"></textarea>
  </div>

</div>

<!-- AUDIO ALWAYS EXISTS -->
<audio id="audio"></audio>

<script>
let tracks = [];
let index = 0;

const audio = document.getElementById("audio");

function render() {
  const color = colorInput.value;
  document.documentElement.style.setProperty("--main", color);

  tracks = tracksInput.value.trim().split("\n");
  index = 0;

  preview.innerHTML = `
  <div class="player">
    <div class="cover" id="cover"></div>
    <div class="title" id="title"></div>

    <div class="progress" id="progress">
      <div class="progress-bar" id="bar"></div>
    </div>

    <div class="controls">
      <button id="prev">‚èÆ</button>
      <button id="play">‚ñ∂</button>
      <button id="next">‚è≠</button>
      <button id="listBtn">‚ò∞</button>
    </div>

    <div class="playlist" id="playlist"></div>
  </div>
  `;

  initPlayer();
}

function initPlayer() {
  audio.src = tracks[index];
  title.textContent = getName(tracks[index]);
  cover.style.backgroundImage = `url('${coverInput.value}')`;

  play.onclick = () => audio.paused ? audio.play() : audio.pause();
  next.onclick = () => switchTrack(1);
  prev.onclick = () => switchTrack(-1);
  listBtn.onclick = () =>
    playlist.style.display = playlist.style.display === "block" ? "none" : "block";

  progress.onclick = e =>
    audio.currentTime = (e.offsetX / progress.offsetWidth) * audio.duration;

  audio.ontimeupdate = () =>
    bar.style.width = (audio.currentTime / audio.duration) * 100 + "%";

  audio.onplay = () => play.textContent = "‚è∏";
  audio.onpause = () => play.textContent = "‚ñ∂";
  audio.onended = () => switchTrack(1);

  buildList();
}

function switchTrack(step) {
  index = (index + step + tracks.length) % tracks.length;
  audio.src = tracks[index];
  audio.play();
  title.textContent = getName(tracks[index]);
  buildList();
}

function buildList() {
  playlist.innerHTML = "";
  tracks.forEach((t,i)=>{
    const d = document.createElement("div");
    d.className = "track" + (i===index?" active":"");
    d.textContent = getName(t);
    d.onclick = ()=>{ index=i; audio.src=t; audio.play(); buildList(); };
    playlist.appendChild(d);
  });
}

function getName(url) {
  return decodeURIComponent(url.split("/").pop());
}

function getCode() {
  result.style.display = "block";
  result.value = preview.innerHTML + "\n<audio src=\"" + tracks[0] + "\" controls></audio>";
}

render();
</script>

</body>
</html>
